sudo: required
language: node_js
env:
  global:
  - VERSION=$TRAVIS_TAG
  - VERSION_COMMIT=$TRAVIS_COMMIT
services:
- docker
node_js:
- 10.13
cache:
  directories:
  - node_modules
notifications:
  email: false
  slack:
    rooms:
      secure: M41EEpz9so+pgkRMZIfb3bsbz7Mo1tgSBGzQUh/MMqC9fPcJ+B4hedLZp08UL06VEerE33xjbdOBa7y5NnB76797Z6bl63O/k1ioB8m5EDU8p68iMQT8eykdxDfDPT2714SWgWpA8fYOC0QL+48ELsZHaAAln519WATj6Tn27OyLSmX7Jiki2eXcebEpJp6nJSW6w5aXAjaKoGlhzjFS4hO66xfZ1+inpDvF4EoGE2rixIRRSUVVDty4zCBPnEzb8NPM2CcStxUHxUOpdbHtxffBJGd89JhX+I08xEB83GFa2cVZXFjnSZ0zBv1wvdjhk95O/PHgb88dLWDVJ2TBRdsdlJ4Dd/RQvhDHTJmATBPjgbMIZLmji+T30XZI6yowrEJx2OsKCa+Avo0C5kJlhfOo7E5LLE2CNNqS/INjGsGG4uvBh2w3hhqun96DTe+GaEYO9jPAva5wETxOjeNzTR1l9xmVaUWbz4BG2tz+18C3lV/rPaxRmSur9qPFenSn5iIMfp/o/TmQ2rg4VCS1eNTdonhOq/BG2CPaJClrbaUMdA7NKcOkIjYjVoMn0GGJZ4/NMqx7W/xdGVDUlJqNVjo7W/7pzu3t8pRtpjPGOkIrlJ86SdLKbnoVatbLBOHPqS3tsqBc9hHcN/GB8ka8p4oC0t7qGGOLcDEXxCWsnT8=
    on_success: never
    on_failure: always
    on_pull_requests: false
before_install:
- npm install -g greenkeeper-lockfile@1
install:
- npm install
- 'curl -fSL "https://releases.hashicorp.com/terraform/0.11.10/terraform_0.11.10_linux_amd64.zip"
  -o terraform.zip && \

  echo "43543a0e56e31b0952ea3623521917e060f2718ab06fe2b2d506cfaa14d54527 *terraform.zip"
  | sha256sum -c - && \

  sudo unzip -d /usr/local/bin/ terraform.zip

  '
before_script:
- npm prune
- greenkeeper-lockfile-update
script:
- 'npm test && \

  npm run build && \

  npm run docker:test

  '
after_success:
- npm run coveralls
- npm run semantic-release
- '([ "$TRAVIS_BRANCH" == "master" ] && [ "$TRAVIS_PULL_REQUEST" == "false" ] || [
  -n "$TRAVIS_TAG" ]) && \

  echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin &&
  \

  npm run push

  '
- '[ -n "$TRAVIS_TAG" ] && npm run deploy

  '
after_script:
- greenkeeper-lockfile-upload
