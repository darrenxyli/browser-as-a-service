sudo: required
language: node_js
env:
  global:
  - VERSION=$TRAVIS_TAG
  - VERSION_COMMIT=$TRAVIS_COMMIT
services:
- docker
node_js:
- 10.13
cache:
  directories:
  - node_modules
notifications:
  email: false
  slack:
    rooms:
      secure: 3oLWtYWy0wTiL+WAkoZX2P20pvKXw/CW7Ehg3PuttXdEFXEFcgBaD7xYBDZZgAXAoCa9cnzk5gltsabblu3iYaO84bi/FwdfTBfy89CdY8Qu3Goz8zlmFPlIgc+shEN3aDb92+AZ70VK+svNHJOX06usn2+FW9K0FtxDRgMEOfq5s9/L42pcfRUzIHlogmMeWgS3xwhZGnLCndFUw4+bNzCqkOH1QaRuStatBtlyC97GtfWRBgAwLLHdJ4yQ3UZctJVLwhsKAeF41BhqvsWcmwM8NrPSRgZx+PHaShsaKu6hGfTuUW+7xtLGF/dHpFe7V8XX3pDPl9dcPNe+oS4HTJxtIy9qrHMuomPsv5h4CmgUAw+wGBnxojqps291czker/gQyrjCgjvZQ/CkIlzHwsGKbxHMLG6ERxXovxTt7ZancU/b2zFrR5H3mWnoNwhuGsYqXsCaKbaT6XXyJCoZbJdXKyVT4j45kfhfKOq4lGKla9FKStEGvbgOvL7HFWLxLenzxgfhgjrK72H341HThDoCtS9dbAdZ8prwtC/Xh87Mj0DejUXfyR2lOUf+ILyLJhrY0llt/CUD9akK9sXb18VjVIOa6OklIVho+A6uvHG9BJ7YQQGBEAMet2xjSJVoWcLI/47SRWiRKN9ibx0qH6bxuh1ZmWz1bzatSDVvKIo=
    on_success: never
    on_failure: always
    on_pull_requests: false
before_install:
- npm install -g greenkeeper-lockfile@1
install:
- npm install
- 'curl -fSL "https://releases.hashicorp.com/terraform/0.11.10/terraform_0.11.10_linux_amd64.zip"
  -o terraform.zip && \

  echo "43543a0e56e31b0952ea3623521917e060f2718ab06fe2b2d506cfaa14d54527 *terraform.zip"
  | sha256sum -c - && \

  sudo unzip -d /usr/local/bin/ terraform.zip

  '
before_script:
- npm prune
- greenkeeper-lockfile-update
script:
- 'npm test && \

  npm run build && \

  npm run docker:test

  '
after_success:
- npm run coveralls
- npm run semantic-release
- '([ "$TRAVIS_BRANCH" == "master" ] && [ "$TRAVIS_PULL_REQUEST" == "false" ] || [
  -n "$TRAVIS_TAG" ]) && \

  echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin &&
  \

  npm run push

  '
- '[ -n "$TRAVIS_TAG" ] && npm run deploy

  '
after_script:
- greenkeeper-lockfile-upload
